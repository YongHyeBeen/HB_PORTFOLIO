#!/usr/bin/python3
# 파일명 : vul_check_U_44.py
# 취약코드 : U-44 (중)
# 점검항목 : root 이외의 UID가 ‘0’금지
# 점검내용 : 사용자 계정 정보가 저장된 파일(예 /etc/passwd)에 root(UID=0) 계정과 동일한 UID(User Identification)를 가진 계정이 존재하는지 점검
# 양호기준 : root 계정과 동일한 UID를 갖는 계정이 존재하지 않는 경우
# 취약기준 : root 계정과 동일한 UID를 갖는 계정이 존재하는 경우

import re

good = "\033[94m양호\033[0m"
bad = "\033[91m취약\033[0m"
filename = "/etc/passwd"
file = open(filename, 'r')
rows = file.read().split("\n")
file.close()

user_list = []
for row in rows:
    if row == '': continue
    data_list = row.split(":")
    user = data_list[0]
    uid = int(data_list[2])
    if user != 'root' and uid == 0:
        user_list.append(user)
        
if len(user_list) > 0:
    print(f"{bad} : root 계정 외의 UID 0번이 발견됨")
    print(f"       - 계정들 : {user_list}")

else:
    print(f"{good} : root 계정 외의 UID 0번이 발견되지 않음 ")
    
